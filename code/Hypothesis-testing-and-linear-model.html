<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Statistical analysis and linear model building</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/readable.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.5.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="report.html">Project Report</a>
</li>
<li>
  <a href="EDA.html">Exploratory Analyses</a>
</li>
<li>
  <a href="Hypothesis-testing-and-linear-model.html">Statistical Analysis</a>
</li>
<li>
  <a href="https://samuelsun.shinyapps.io/cu_shinymap/">Shiny Map for CU Safety</a>
</li>
<li>
  <a>
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/SamuelSun2000/safe_CU.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://data.cityofnewyork.us/Public-Safety/NYPD-Complaint-Data-Current-Year-To-Date-/5uac-w243">
    <span class="fa fa-database fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Statistical analysis and linear model
building</h1>

</div>


<div id="statistical-analysis" class="section level1">
<h1>Statistical analysis</h1>
<div id="anova-test---suspects-gender" class="section level2">
<h2>Anova test - suspects’ gender</h2>
<p>Whether there is a significant difference in the number of male and
female suspects. We calculate how many male and female suspects in
month, year, then plot the disturbution of number of male and female
suspects.</p>
<pre class="r"><code>data &lt;- read_csv(&quot;../data/full_filter_data.csv&quot;)

gender_data &lt;- data %&gt;%  
  group_by(year, month, susp_sex) %&gt;% 
  summarise(number = n()) %&gt;% 
  mutate(susp_sex = as.factor(susp_sex)) %&gt;%
  filter(susp_sex %in% c(&quot;F&quot;, &quot;M&quot;, &quot;U&quot;))
aov_model_1 &lt;- aov(number ~ susp_sex, data = gender_data)

aov_model_1 %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable(digits = 4, align = &#39;c&#39;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">df</th>
<th align="center">sumsq</th>
<th align="center">meansq</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">susp_sex</td>
<td align="center">2</td>
<td align="center">22482073</td>
<td align="center">11241036.36</td>
<td align="center">397.0255</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">Residuals</td>
<td align="center">456</td>
<td align="center">12910789</td>
<td align="center">28313.13</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<p>There is a significant difference in the number of male and female
suspects. Through the boxplot in EDA part, we could easily see that male
is more likely to be suspects than females if we consider the
unknown.</p>
</div>
<div id="t-test---victims-gender" class="section level2">
<h2>T test - victims’ gender</h2>
<p>We wonder whether there is a significant difference in the number of
male and female victims. So we calculate how many male and female
victims in month, year, then plot the disturbution of number of male and
female victims. And I also do the same steps for vic_sex include
D=Business/Organization, E=PSNY/People of the State of New York.</p>
<pre class="r"><code>data &lt;- read_csv(&quot;../data/full_filter_data.csv&quot;)
female &lt;- data %&gt;%  
  group_by(year, month, vic_sex) %&gt;% 
  summarise(number = n()) %&gt;% 
  mutate(vic_sex = as.factor(vic_sex)) %&gt;%
  filter(vic_sex %in% c(&quot;F&quot;))

male &lt;- data %&gt;%  
  group_by(year, month, vic_sex) %&gt;% 
  summarise(number = n()) %&gt;% 
  mutate(vic_sex = as.factor(vic_sex)) %&gt;%
  filter(vic_sex %in% c(&quot;M&quot;))

t.test(pull(female, number), pull(male, number)) %&gt;% broom::glance() %&gt;% 
  knitr::kable(digits = 4, align = &#39;c&#39;)</code></pre>
<table>
<colgroup>
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
<col width="20%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">estimate</th>
<th align="center">estimate1</th>
<th align="center">estimate2</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
<th align="center">parameter</th>
<th align="center">conf.low</th>
<th align="center">conf.high</th>
<th align="center">method</th>
<th align="center">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">-117.817</td>
<td align="center">469.2353</td>
<td align="center">587.0523</td>
<td align="center">-11.0482</td>
<td align="center">0</td>
<td align="center">286.4321</td>
<td align="center">-138.8066</td>
<td align="center">-96.8274</td>
<td align="center">Welch Two Sample t-test</td>
<td align="center">two.sided</td>
</tr>
</tbody>
</table>
<p>There is a significant difference in the number of male and female
suspects. Through the boxplot, though compared to the suspect, the
female victim number rises a lot, male is still more likely to be
victims than females.</p>
</div>
<div
id="logistic-regression---suspects-gender-and-crime-successful-rate"
class="section level2">
<h2>Logistic regression - suspects’ gender and crime successful
rate</h2>
<pre class="r"><code>data &lt;- read_csv(&quot;../data/full_filter_data.csv&quot;)
gender_data_rate &lt;- data %&gt;%  
  filter(susp_sex %in% c(&quot;F&quot;, &quot;M&quot;, &quot;U&quot;)) %&gt;%
  mutate(success_fail = ifelse(success_fail == &quot;COMPLETED&quot;, 1, 0))

reg_successrate = glm(success_fail ~ susp_sex, family=binomial(link=&quot;logit&quot;), data = gender_data_rate)

reg_successrate %&gt;% 
  broom::tidy() %&gt;%
  knitr::kable(digits = 4, align = &#39;c&#39;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">estimate</th>
<th align="center">std.error</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(Intercept)</td>
<td align="center">4.0271</td>
<td align="center">0.0475</td>
<td align="center">84.8640</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">susp_sexM</td>
<td align="center">-0.4020</td>
<td align="center">0.0512</td>
<td align="center">-7.8548</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="center">susp_sexU</td>
<td align="center">0.3592</td>
<td align="center">0.0613</td>
<td align="center">5.8628</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>gender_data_rate %&gt;% 
  group_by(year, success_fail, susp_sex) %&gt;% 
  summarise(number = n()) %&gt;%
  mutate(success_fail = ifelse(success_fail == 1, &quot;COMPLETED&quot;, &quot;ATTEMPTED&quot;)) %&gt;%
  pivot_wider(
  names_from = &quot;success_fail&quot;, 
  values_from = &quot;number&quot;) %&gt;%
  mutate(total = ATTEMPTED+COMPLETED, 
         rate = COMPLETED/total) %&gt;%
  plot_ly(x = ~ susp_sex, y = ~ rate, type = &quot;box&quot;, color = ~ susp_sex, colors = &quot;viridis&quot;) %&gt;% 
  layout(xaxis = list(title = &quot;Suspects&#39; Gender&quot;), yaxis = list(title = &quot;Rate&quot;))</code></pre>
<div id="htmlwidget-2baa4edbbbd6c3e4890e" style="width:75%;height:307.2px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-2baa4edbbbd6c3e4890e">{"x":{"visdat":{"6abf6073f985":["function () ","plotlyVisDat"]},"cur_data":"6abf6073f985","attrs":{"6abf6073f985":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Suspects' Gender","type":"category","categoryorder":"array","categoryarray":["F","M","U"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Rate"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(68,1,84,0.5)","x":["F","F","F","F","F","F","F","F","F","F","F","F","F"],"y":[0.98740377886634,0.982089552238806,0.976951672862454,0.985998526160649,0.981098641464855,0.980605120248254,0.980213692125049,0.98111753371869,0.979537703675635,0.985616956850871,0.982175783650891,0.985825331504344,0.98539751216874],"type":"box","name":"F","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(33,144,141,0.5)","x":["M","M","M","M","M","M","M","M","M","M","M","M","M"],"y":[0.967706259677063,0.964928057553957,0.962820512820513,0.968861771512729,0.974316759960487,0.973011909335382,0.971693602371617,0.973509933774834,0.975790921595598,0.977116505699121,0.97785051827605,0.979504851727578,0.977955478711908],"type":"box","name":"M","marker":{"color":"rgba(33,144,141,1)","line":{"color":"rgba(33,144,141,1)"}},"line":{"color":"rgba(33,144,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(253,231,37,0.5)","x":["U","U","U","U","U","U","U","U","U","U","U","U","U"],"y":[0.987708066581306,0.985647530040053,0.984214898919967,0.984870958172649,0.989798657718121,0.987642807181161,0.987602390967456,0.988103408830931,0.985812356979405,0.988991237924062,0.990720193665524,0.987683823529412,0.989216092907507],"type":"box","name":"U","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>There is a significant relationship between gender of suspects and
successful rate. Through the boxplot, we could see that distribution of
the successful rate of male suspects is lower than distribution of the
successful rate of female suspects.</p>
</div>
<div id="logistic-regression---victims-gender-and-crime-successful-rate"
class="section level2">
<h2>Logistic regression - victims’ gender and crime successful rate</h2>
<pre class="r"><code>data &lt;- read_csv(&quot;../data/full_filter_data.csv&quot;)
gender_data_rate_1 &lt;- data %&gt;%  
  filter(vic_sex %in% c(&quot;F&quot;, &quot;M&quot;)) %&gt;%
  mutate(success_fail = ifelse(success_fail == &quot;COMPLETED&quot;, 1, 0))

reg_successrate_1 = glm(success_fail ~ vic_sex, family=binomial(link=&quot;logit&quot;), data = gender_data_rate_1)

reg_successrate_1 %&gt;% 
  broom::tidy() %&gt;%
  knitr::kable(digits = 4, align = &#39;c&#39;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">estimate</th>
<th align="center">std.error</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(Intercept)</td>
<td align="center">4.1047</td>
<td align="center">0.0295</td>
<td align="center">138.9947</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">vic_sexM</td>
<td align="center">-0.4281</td>
<td align="center">0.0365</td>
<td align="center">-11.7174</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>gender_data_rate_1 %&gt;% 
  group_by(year, success_fail, vic_sex) %&gt;% 
  summarise(number = n()) %&gt;%
  mutate(success_fail = ifelse(success_fail == 1, &quot;COMPLETED&quot;, &quot;ATTEMPTED&quot;)) %&gt;%
  pivot_wider(
  names_from = &quot;success_fail&quot;, 
  values_from = &quot;number&quot;) %&gt;%
  mutate(total = ATTEMPTED+COMPLETED, 
         rate = COMPLETED/total) %&gt;%
  plot_ly(x = ~ vic_sex, y = ~rate, type = &quot;box&quot;, color = ~ vic_sex, colors = &quot;viridis&quot;) %&gt;% 
  layout(xaxis = list(title = &quot;Victims&#39; Gender&quot;), yaxis = list(title = &quot;Rate&quot;))</code></pre>
<div id="htmlwidget-10c161e401fed1b368a7" style="width:75%;height:307.2px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-10c161e401fed1b368a7">{"x":{"visdat":{"6abf593f5b5":["function () ","plotlyVisDat"]},"cur_data":"6abf593f5b5","attrs":{"6abf593f5b5":{"x":{},"y":{},"color":{},"colors":"viridis","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Victims' Gender","type":"category","categoryorder":"array","categoryarray":["F","M"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Rate"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(68,1,84,0.5)","x":["F","F","F","F","F","F","F","F","F","F","F","F","F"],"y":[0.983039896624132,0.982822737736851,0.97986798679868,0.982315648982316,0.986401673640167,0.986036519871106,0.983784716232534,0.985963041933191,0.983447790103891,0.984496124031008,0.984165923282783,0.98097936058276,0.986450466459351],"type":"box","name":"F","marker":{"color":"rgba(68,1,84,1)","line":{"color":"rgba(68,1,84,1)"}},"line":{"color":"rgba(68,1,84,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(253,231,37,0.5)","x":["M","M","M","M","M","M","M","M","M","M","M","M","M"],"y":[0.974923801607093,0.969040744305422,0.971039929793769,0.971753016323634,0.977906445223221,0.975440090857467,0.976180164573408,0.976368706883898,0.976406779661017,0.975854584915898,0.979375537095388,0.977492877492877,0.976835185475035],"type":"box","name":"M","marker":{"color":"rgba(253,231,37,1)","line":{"color":"rgba(253,231,37,1)"}},"line":{"color":"rgba(253,231,37,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
<p>Through the summary, we could see that crimes on male is
significantly less to success (though still at a high ratio). According
to the boxplot, we could see that distribution of the successful rate of
male victims is also lower than distribution of the successful rate of
male victims.</p>
</div>
<div id="correlation-between-crime-number-and-time"
class="section level2">
<h2>Correlation between crime number and time</h2>
<p>In the EDA part, we see that there exist some pattern in month and
time in one day, but is it only random error and fluctuation, or there
exist a significant difference?</p>
<div id="anova-test---crime-number-and-month" class="section level3">
<h3>Anova test - crime number and month</h3>
<p>We use group_by and summarize function to get the number of cases in
each month and year, and then use the number of cases and month_data to
make an ANOVA model to test whether there is a significant difference of
number of crime cases among each month.</p>
<pre class="r"><code>data &lt;- read_csv(&quot;../data/full_filter_data.csv&quot;)

month_data &lt;- data %&gt;%  
  group_by(year, month) %&gt;% 
  summarise(number = n()) %&gt;% 
  mutate(month = as.factor(month),
         year = as.factor(year))

aov_model &lt;- aov(number ~ month, data = month_data) 

aov_model %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable(digits = 4, align = &#39;c&#39;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">df</th>
<th align="center">sumsq</th>
<th align="center">meansq</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">month</td>
<td align="center">11</td>
<td align="center">5347936</td>
<td align="center">486176.01</td>
<td align="center">14.1524</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="center">Residuals</td>
<td align="center">141</td>
<td align="center">4843764</td>
<td align="center">34352.94</td>
<td align="center">NA</td>
<td align="center">NA</td>
</tr>
</tbody>
</table>
<p>By the result above, we find that there are very significant
difference in the crime numbers between months. Therefore, we utilized
Tukey’s method for post hoc tests, to see which months are
different.</p>
<p>Firstly, we use Turkey methods to analyze the ANOVA model, select the
variables which p-value are smaller than 0.05, and arrange them by adj
p_value. Then, we separate the contrast to A and B and add two variables
“high” and “low” depending on whether estimate is larger than 0 to
decide how A and B to fit high and low. Finally, we make a two panel
plot to show the order of the months become “high” and “low” in the
process of comparing.</p>
<pre class="r"><code>aov_posthoc &lt;- TukeyHSD(aov_model, conf.level = .95) %&gt;% 
  broom::tidy() %&gt;% 
  filter(adj.p.value &lt; 0.05) %&gt;% 
  arrange(adj.p.value)

aov_posthoc %&gt;% 
  head(5) %&gt;% 
  knitr::kable(digits = 4 )</code></pre>
<table>
<colgroup>
<col width="8%" />
<col width="13%" />
<col width="16%" />
<col width="14%" />
<col width="14%" />
<col width="14%" />
<col width="17%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="left">contrast</th>
<th align="right">null.value</th>
<th align="right">estimate</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="right">adj.p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">month</td>
<td align="left">8-2</td>
<td align="right">0</td>
<td align="right">566.5385</td>
<td align="right">324.9066</td>
<td align="right">808.1704</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">month</td>
<td align="left">7-2</td>
<td align="right">0</td>
<td align="right">537.9231</td>
<td align="right">296.2912</td>
<td align="right">779.5550</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">month</td>
<td align="left">12-8</td>
<td align="right">0</td>
<td align="right">-506.5705</td>
<td align="right">-753.1850</td>
<td align="right">-259.9560</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">month</td>
<td align="left">5-2</td>
<td align="right">0</td>
<td align="right">485.3077</td>
<td align="right">243.6758</td>
<td align="right">726.9396</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">month</td>
<td align="left">9-2</td>
<td align="right">0</td>
<td align="right">474.6154</td>
<td align="right">232.9835</td>
<td align="right">716.2473</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<pre class="r"><code>aov_group &lt;- aov_posthoc %&gt;% 
  separate(contrast, sep = &quot;-&quot;, into = c(&quot;A&quot;, &quot;B&quot;)) %&gt;% 
  mutate(high = if_else(estimate &gt; 0, true = A, false = B),
         low = if_else(estimate &gt; 0, true = B, false = A)) %&gt;% 
  mutate(high = fct_infreq(high),
         low = fct_infreq(low))

aov_fig1 &lt;- aov_group %&gt;% 
  ggplot(aes(x = high, fill = high)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Month&quot;, y = &quot;Count&quot;, title = 
         &quot;Months Having More Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)

aov_fig2 &lt;- aov_group %&gt;% 
  ggplot(aes(x = low, fill = low)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Month&quot;, y = &quot;Count&quot;,title = 
         &quot;Months Having Fewer Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)

aov_fig1 / aov_fig2</code></pre>
<p><img src="Hypothesis-testing-and-linear-model_files/figure-html/unnamed-chunk-6-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>After pairwise independent multiple tests, we can draw the
conclusion. We can roughly divide the months in one year into 3 groups.
July, August, October, May, June, September generally have more crimes.
February, January, November, December have fewer crimes. While March and
April is at medium level, the crime number in this two months are
significantly less than those months with excessive crimes, but also
significantly more than months that have fewest crimes.</p>
</div>
<div id="anova-test---crime-number-and-hour" class="section level3">
<h3>Anova test - crime number and hour</h3>
<p>Next, we repeat the steps, to see whether crime number at different
time in a day have significant difference.We use group_by and summarize
function to get the number of cases in each hour, arrange hour from 0 to
23, and then use the number of cases and hour_data to make an ANOVA
model to test whether there is a significant difference of number of
crime cases among each hour.</p>
<pre class="r"><code># Is there differnece between case numbers in every hour? 
hour_data = data %&gt;% 
  group_by(year, month, hour) %&gt;% 
  summarise(number = n()) %&gt;%
  mutate(hour = as.factor(hour),
    hour = fct_inseq(hour)) 

aov_hour &lt;- aov(number ~ hour, data = hour_data)

aov_hour %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable(digits = 4 )</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hour</td>
<td align="right">23</td>
<td align="right">3889921</td>
<td align="right">169126.9830</td>
<td align="right">594.794</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">3648</td>
<td align="right">1037292</td>
<td align="right">284.3455</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>By the result above, there are also significant difference in the
mean number of crimes between different hours in one day.</p>
<p>Afterwards, we use Turkey methods to analyze the ANOVA model, steps
is consistent with text above.</p>
<pre class="r"><code>hour_posthoc &lt;- TukeyHSD(aov_hour, conf.level = .95) %&gt;% 
  broom::tidy() %&gt;% 
  filter(adj.p.value &lt; 0.05) %&gt;% 
  arrange(adj.p.value)

hour_group &lt;- hour_posthoc %&gt;% 
  separate(contrast, sep = &quot;-&quot;, into = c(&quot;A&quot;, &quot;B&quot;)) %&gt;% 
  mutate(high = if_else(estimate &gt; 0, true = A, false = B),
         low = if_else(estimate &gt; 0, true = B, false = A)) %&gt;% 
  mutate(high = fct_infreq(high),
         low = fct_infreq(low))

aov_fig3 &lt;- hour_group %&gt;% 
  ggplot(aes(x = high, fill = high)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Hour&quot;, y = &quot;Count&quot;, title = 
         &quot;Hours Having More Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)+
  theme(plot.title = element_text(hjust = 0.5))

aov_fig4 &lt;- hour_group %&gt;% 
  ggplot(aes(x = low, fill = low)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Hour&quot;, y = &quot;Count&quot;,title = 
         &quot;Hours Having Fewer Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)+
  theme(plot.title = element_text(hjust = 0.5))

aov_fig3 / aov_fig4</code></pre>
<p><img src="Hypothesis-testing-and-linear-model_files/figure-html/unnamed-chunk-8-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The result corresponded with the findings in EDA part. The most
dangerous hour is 12:00 - 21:00, all of them are at high ranks in the
left figure. Comparatively, 1:00 - 9:00 is the most peaceful time. But
it’s our consensus that midnights are more hazardous. So we questioned
on if more severe levels of crimes take place more in the midnights.</p>
</div>
<div id="anova-test---felony-crime-number-and-hour"
class="section level3">
<h3>Anova test - FELONY crime number and hour</h3>
<p>We use group_by and summarize function to get the number of cases in
each level, hour, month and year, and select the data which level equals
FELONY, then use the number of cases and hour_level to make an ANOVA
model to test whether there is a significant difference of level of
crime cases among each hour. Then, we use Turkey methods to analyze the
ANOVA model. The other steps is consistent with text above.</p>
<pre class="r"><code>hour_level = data %&gt;% 
  group_by(year, month, hour, level) %&gt;% 
  filter(level == &quot;FELONY&quot;) %&gt;% 
  summarise(number = n()) %&gt;%
  mutate(hour = as.factor(hour),
    hour = fct_inseq(hour)) 

aov_level &lt;- aov(number ~ hour, data = hour_level)

aov_level %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable(digits = 4 )</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">hour</td>
<td align="right">23</td>
<td align="right">252643.9</td>
<td align="right">10984.5174</td>
<td align="right">281.7942</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">3648</td>
<td align="right">142201.4</td>
<td align="right">38.9806</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<pre class="r"><code>level_posthoc &lt;- TukeyHSD(aov_level, conf.level = .95) %&gt;% 
  broom::tidy() %&gt;% 
  filter(adj.p.value &lt; 0.05) %&gt;% 
  arrange(adj.p.value)

level_group &lt;- level_posthoc %&gt;% 
  separate(contrast, sep = &quot;-&quot;, into = c(&quot;A&quot;, &quot;B&quot;)) %&gt;% 
  mutate(high = if_else(estimate &gt; 0, true = A, false = B),
         low = if_else(estimate &gt; 0, true = B, false = A)) %&gt;% 
  mutate(high = fct_infreq(high),
         low = fct_infreq(low))

aov_fig5 &lt;- level_group %&gt;% 
  ggplot(aes(x = high, fill = high)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Hour&quot;, y = &quot;Count&quot;, title = 
         &quot;Hours Having More Felony Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)+
  theme(plot.title = element_text(hjust = 0.5))

aov_fig6 &lt;- level_group %&gt;% 
  ggplot(aes(x = low, fill = low)) +
  geom_bar(stat = &quot;count&quot;) +
  labs(x = &quot;Hour&quot;, y = &quot;Count&quot;,title = 
         &quot;Hours Having Fewer Felony Crimes \n in Multiple Comparisons&quot;) + guides(fill = &quot;none&quot;)+
  theme(plot.title = element_text(hjust = 0.5))

aov_fig5 / aov_fig6</code></pre>
<p><img src="Hypothesis-testing-and-linear-model_files/figure-html/unnamed-chunk-9-1.png" width="75%" style="display: block; margin: auto;" /></p>
<p>The conclusion still holds true: afternoon is more dangerous. Be
cautious! What time you think is safe may be dangerous than your
thought.</p>
</div>
</div>
</div>
<div id="build-linear-model-for-prediction" class="section level1">
<h1>Build linear model for prediction</h1>
<p>All variables are categorical, except the response variable crime
number. After plotting the histogram, we find the crime number is
strongly right-skewed. Using boxcox transformation, we take logarithm of
number and the data looks much more normally distributed. We decide to
select meaningful age and male and female of gender to do the following
prediction. Then we make a lm model to use month, hour, vic_age,
vic_race, and vic_sex as predictors. Then we summary the model to get
results to test significance of each predictor. Finally, we make a
boxplot of the distribution of RMSE/IQR (normalized RMSE).</p>
<pre class="r"><code># find that group by day, every day there are too few cases, not appropriate for prediction, so we choose to ignore the day variable
set.seed(1244)
lm_data &lt;- data %&gt;% 
  filter(vic_age %in% c(&quot;&lt;18&quot;, &quot;18-24&quot;, &quot;25-44&quot;, &quot;45-64&quot;, &quot;65+&quot;)) %&gt;% 
  filter(vic_sex %in% c(&quot;M&quot;, &quot;F&quot;)) %&gt;%
  filter(vic_race != &quot;(null)&quot;) %&gt;% 
  mutate_at(c(&quot;month&quot;, &quot;hour&quot;, &quot;vic_age&quot;, &quot;vic_race&quot;, &quot;vic_sex&quot;), as.factor) %&gt;% 
  group_by(month, hour, vic_age, vic_race, vic_sex) %&gt;% 
  summarise(log_number = log(n())) 

lm_model &lt;- lm(log_number ~ . , data = lm_data)

options(digits = 4)

summary(lm_model, correlation = FALSE) %&gt;% 
  broom::tidy() %&gt;% 
  knitr::kable(align = &#39;c&#39;, caption = &quot;Linear model parameters&quot;)</code></pre>
<table>
<caption>Linear model parameters</caption>
<thead>
<tr class="header">
<th align="center">term</th>
<th align="center">estimate</th>
<th align="center">std.error</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">(Intercept)</td>
<td align="center">-1.5058</td>
<td align="center">0.0393</td>
<td align="center">-38.3320</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">month2</td>
<td align="center">-0.0464</td>
<td align="center">0.0238</td>
<td align="center">-1.9533</td>
<td align="center">0.0508</td>
</tr>
<tr class="odd">
<td align="center">month3</td>
<td align="center">0.0774</td>
<td align="center">0.0236</td>
<td align="center">3.2781</td>
<td align="center">0.0010</td>
</tr>
<tr class="even">
<td align="center">month4</td>
<td align="center">0.0735</td>
<td align="center">0.0236</td>
<td align="center">3.1104</td>
<td align="center">0.0019</td>
</tr>
<tr class="odd">
<td align="center">month5</td>
<td align="center">0.2214</td>
<td align="center">0.0235</td>
<td align="center">9.4388</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">month6</td>
<td align="center">0.2671</td>
<td align="center">0.0234</td>
<td align="center">11.3998</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">month7</td>
<td align="center">0.2909</td>
<td align="center">0.0233</td>
<td align="center">12.4718</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">month8</td>
<td align="center">0.2773</td>
<td align="center">0.0234</td>
<td align="center">11.8505</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">month9</td>
<td align="center">0.2856</td>
<td align="center">0.0235</td>
<td align="center">12.1713</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">month10</td>
<td align="center">0.1403</td>
<td align="center">0.0235</td>
<td align="center">5.9638</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">month11</td>
<td align="center">0.0413</td>
<td align="center">0.0235</td>
<td align="center">1.7554</td>
<td align="center">0.0792</td>
</tr>
<tr class="even">
<td align="center">month12</td>
<td align="center">-0.0171</td>
<td align="center">0.0236</td>
<td align="center">-0.7247</td>
<td align="center">0.4686</td>
</tr>
<tr class="odd">
<td align="center">hour1</td>
<td align="center">-0.1825</td>
<td align="center">0.0344</td>
<td align="center">-5.3102</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour2</td>
<td align="center">-0.3163</td>
<td align="center">0.0349</td>
<td align="center">-9.0652</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour3</td>
<td align="center">-0.3901</td>
<td align="center">0.0352</td>
<td align="center">-11.0760</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour4</td>
<td align="center">-0.4544</td>
<td align="center">0.0360</td>
<td align="center">-12.6362</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour5</td>
<td align="center">-0.6499</td>
<td align="center">0.0363</td>
<td align="center">-17.8809</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour6</td>
<td align="center">-0.7334</td>
<td align="center">0.0358</td>
<td align="center">-20.4907</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour7</td>
<td align="center">-0.3137</td>
<td align="center">0.0341</td>
<td align="center">-9.2079</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour8</td>
<td align="center">-0.0269</td>
<td align="center">0.0332</td>
<td align="center">-0.8111</td>
<td align="center">0.4173</td>
</tr>
<tr class="odd">
<td align="center">hour9</td>
<td align="center">0.0293</td>
<td align="center">0.0330</td>
<td align="center">0.8868</td>
<td align="center">0.3752</td>
</tr>
<tr class="even">
<td align="center">hour10</td>
<td align="center">0.1247</td>
<td align="center">0.0330</td>
<td align="center">3.7783</td>
<td align="center">0.0002</td>
</tr>
<tr class="odd">
<td align="center">hour11</td>
<td align="center">0.1929</td>
<td align="center">0.0327</td>
<td align="center">5.8923</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour12</td>
<td align="center">0.3899</td>
<td align="center">0.0324</td>
<td align="center">12.0161</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour13</td>
<td align="center">0.3674</td>
<td align="center">0.0326</td>
<td align="center">11.2777</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour14</td>
<td align="center">0.4884</td>
<td align="center">0.0322</td>
<td align="center">15.1804</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour15</td>
<td align="center">0.6093</td>
<td align="center">0.0323</td>
<td align="center">18.8838</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour16</td>
<td align="center">0.6033</td>
<td align="center">0.0322</td>
<td align="center">18.7278</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour17</td>
<td align="center">0.5842</td>
<td align="center">0.0323</td>
<td align="center">18.0674</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour18</td>
<td align="center">0.5743</td>
<td align="center">0.0323</td>
<td align="center">17.7643</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour19</td>
<td align="center">0.4524</td>
<td align="center">0.0325</td>
<td align="center">13.9123</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour20</td>
<td align="center">0.4142</td>
<td align="center">0.0326</td>
<td align="center">12.6987</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour21</td>
<td align="center">0.2844</td>
<td align="center">0.0331</td>
<td align="center">8.6005</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">hour22</td>
<td align="center">0.1839</td>
<td align="center">0.0335</td>
<td align="center">5.4892</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">hour23</td>
<td align="center">0.0922</td>
<td align="center">0.0337</td>
<td align="center">2.7384</td>
<td align="center">0.0062</td>
</tr>
<tr class="even">
<td align="center">vic_age18-24</td>
<td align="center">0.6691</td>
<td align="center">0.0165</td>
<td align="center">40.4323</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">vic_age25-44</td>
<td align="center">1.7845</td>
<td align="center">0.0163</td>
<td align="center">109.7964</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">vic_age45-64</td>
<td align="center">1.1759</td>
<td align="center">0.0164</td>
<td align="center">71.8018</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">vic_age65+</td>
<td align="center">-0.2352</td>
<td align="center">0.0178</td>
<td align="center">-13.1836</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">vic_raceASIAN/PACIFIC</td>
<td align="center">1.2560</td>
<td align="center">0.0263</td>
<td align="center">47.8290</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">vic_raceBLACK</td>
<td align="center">2.9660</td>
<td align="center">0.0255</td>
<td align="center">116.4605</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">vic_raceBLACK HISPANIC</td>
<td align="center">1.5530</td>
<td align="center">0.0258</td>
<td align="center">60.2901</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">vic_raceUNKNOWN</td>
<td align="center">0.9728</td>
<td align="center">0.0263</td>
<td align="center">36.9415</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">vic_raceWHITE</td>
<td align="center">2.1920</td>
<td align="center">0.0256</td>
<td align="center">85.4883</td>
<td align="center">0.0000</td>
</tr>
<tr class="odd">
<td align="center">vic_raceWHITE HISPANIC</td>
<td align="center">2.5362</td>
<td align="center">0.0255</td>
<td align="center">99.4092</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="center">vic_sexM</td>
<td align="center">0.2796</td>
<td align="center">0.0097</td>
<td align="center">28.9211</td>
<td align="center">0.0000</td>
</tr>
</tbody>
</table>
<pre class="r"><code>summary(lm_model) %&gt;% 
  broom::glance() %&gt;% 
  knitr::kable(align = &#39;c&#39;, caption = &quot;Linear model statistics&quot;)</code></pre>
<table>
<caption>Linear model statistics</caption>
<colgroup>
<col width="14%" />
<col width="19%" />
<col width="10%" />
<col width="14%" />
<col width="11%" />
<col width="5%" />
<col width="16%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">r.squared</th>
<th align="center">adj.r.squared</th>
<th align="center">sigma</th>
<th align="center">statistic</th>
<th align="center">p.value</th>
<th align="center">df</th>
<th align="center">df.residual</th>
<th align="center">nobs</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">0.7564</td>
<td align="center">0.7556</td>
<td align="center">0.5803</td>
<td align="center">1009</td>
<td align="center">0</td>
<td align="center">45</td>
<td align="center">14622</td>
<td align="center">14668</td>
</tr>
</tbody>
</table>
<pre class="r"><code>cv_result =
  crossv_mc(lm_data, 100) %&gt;% 
  mutate(model = map(train, ~lm(log_number ~ ., data =.x))) %&gt;% 
  mutate(rmse = map2_dbl(model, test,
                         ~rmse(model = .x, data = .y)))

sum_number &lt;- summary(lm_data$log_number) %&gt;% 
  broom::tidy()

IQR &lt;- sum_number$q3 - sum_number$q1

cv_result %&gt;% 
  select(starts_with(&quot;rmse&quot;)) %&gt;% 
  pivot_longer(
    everything(),
    names_to = &quot;model&quot;, 
    values_to = &quot;rmse&quot;,
    names_prefix = &quot;rmse_&quot;) %&gt;% 
  mutate(model = fct_inorder(model)) %&gt;% 
  ggplot(aes(x = model, y = rmse/IQR)) + geom_boxplot() +
  labs(x = &quot;Model&quot;, y = &quot;RMSE/IQR&quot;, title = &quot;Distribution of RMSDIQR&quot;) +
  theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="Hypothesis-testing-and-linear-model_files/figure-html/unnamed-chunk-10-1.png" width="65%" style="display: block; margin: auto;" /></p>
<p>The model fits so well as the adjusted R squared is 0.756 with a
extreme small p value. Moreover, we use normalized RMSE as the reference
to evaluate the prediction ability of this model. It turns out to be
good compared to the IQR, which means it’s prediction error is less than
<span class="math inline">\(\frac{1}{3}\)</span> IQR.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
