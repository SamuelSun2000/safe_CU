---
title: "Shiny Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---

```{r setup, include=FALSE}
library(tidyverse)
library(plotly)

cu_df = read_csv("../data/full_filter_data.csv")
```

Column {.sidebar}
-----------------------------------------------------------------------

```{r}
Year0 = cu_df %>% distinct(year) 
Year1 = arrange(Year0, desc(year))

selectInput(
  inputId = 'year_choice',
  label = h3('Year Choice'),
  choices = Year1,
  selected = '2022'
)

Month0 = cu_df %>% distinct(month) 
Month1 = arrange(Month0, month)

selectInput(
  inputId = 'month_choice',
  label = h3('Month Choice'),
  choices = Month1,
  selected = '1'
)

Day0 = cu_df %>% distinct(day) 
Day1 = arrange(Day0, day)

selectInput(
  inputId = 'day_choice',
  label = h3('Day Choice'),
  choices = Day1,
  selected = '1'
)

sliderInput(
  inputId = 'time_range',
  label = h3('Time Range'),
  min = 0, max = 24, value = c(8, 18)
)
```

sliderInput(
  inputId = 'price_range',
  label = h3('Price Range'),
  min = 50, max = 1000, value = c(100, 250)
)

room_types = nyc_airbnb %>% distinct(room_type) %>% pull()

radioButtons(
  inputId = 'room_choice',
  label = h3('Room Type'),
  choices = room_types,
  selected = 'Entire home/apt'   ##this decides the default choice
)


Column 
-----------------------------------------------------------------------

### Safety Map around Columbia University

```{r}

```

renderPlotly({
  nyc_airbnb %>% 
    filter(borough == input[['borough_choice']],
           price >= input[['price_range']][1],
           price <= input[['price_range']][2],
           room_type == input[['room_choice']]) %>% 
    plot_ly(x = ~lat, y = ~long, color = ~price,
           type = 'scatter', mode = 'markers', alpha = .5)
})